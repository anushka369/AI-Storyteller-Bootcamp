# Interactive AI StoryTeller

**One‑line:** An end‑to‑end Colab + Streamlit project that generates multi‑image, multi‑chapter stories by combining image captioning (BLIP), generative text (Google Gemini), and export options (PDF + MP3).

---

## Overview

This repository contains a Colab notebook and a Streamlit app that let users upload images, generate captions using BLIP, and then produce creative stories using the Google Gemini model. The project also supports exporting the generated story as PDF and MP3 audio (gTTS), and provides a simple interactive UI for experiments.

The project was developed during the Interactive AI StoryTeller Bootcamp and matches the Bootcamp submission requirements (notebook, slides, and short screen recording). See Bootcamp guidelines for submission instructions.

---

## Key Features

* Image captioning with **Salesforce/blip-image-captioning-large**
* Story generation via **Google Gemini** (configured to `gemini-2.5-flash` in the notebook)
* Multi-image story outline -> multi-chapter generation flow
* Exports: story text file, PDF (reportlab), MP3 audio (gTTS)
* Streamlit web UI with optional ngrok tunnelling for public access
* Example notebook workflow configured for Google Colab

---

## Tech Stack / Libraries

* Python 3.8+
* transformers (Hugging Face)
* timm
* pillow
* google-generativeai (Gemini client)
* Salesforce BLIP (via transformers)
* reportlab (PDF export)
* gTTS (text-to-speech)
* streamlit
* pyngrok (optional public URL)
* torch
* ipywidgets (for Colab interactive controls)

---

## Files & Outputs

* `DevTown.ipynb` — primary Colab notebook (contains the Day‑1 to Day‑5 flow).
* `app_streamlit_story.py` — Streamlit app for local / server deployment.
* `generated_story.txt`, `multi_image_story.txt` — raw story text outputs.
* `story.pdf` — PDF export (reportlab).
* `*.mp3` — audio exports generated by gTTS (various voices).

---

## Environment variables / API keys

Set the following environment variables before running (Colab or local):

* `GEMINI_API_KEY` – required to call Google Gemini. Do **not** hardcode your key in the repo.
* `NGROK_AUTH_TOKEN` – optional, used only if you want a public ngrok URL for Streamlit.

Example (Linux / macOS):

```bash
export GEMINI_API_KEY="your_gemini_api_key_here"
export NGROK_AUTH_TOKEN="your_ngrok_token_here"
```

**Security note:** Never commit API keys or tokens to source control. Use environment variables or a secrets manager.

---

## Quickstart

### In Google Colab (recommended for GPU / easy file downloads)

1. Open `DevTown.ipynb` in Colab.
2. Run the setup cells to install required packages.
3. Set `GEMINI_API_KEY` in Colab environment (Runtime → Change runtime variables or use `%env GEMINI_API_KEY=...`).
4. Upload images when prompted and follow the interactive widgets to generate captions and stories.
5. Download `generated_story.txt`, `story.pdf`, and MP3 files produced.

### Locally (run Streamlit app)

1. Create and activate a Python virtualenv.

```bash
python -m venv venv
source venv/bin/activate
pip install -r requirements.txt
```

2. Create a `.env` or export the required keys (see Environment variables above).
3. Run the app locally:

```bash
streamlit run app_streamlit_story.py
```

4. (Optional) Start ngrok to expose the app publicly:

```python
from pyngrok import ngrok
ngrok.set_auth_token("<NGROK_AUTH_TOKEN>")
ngrok.connect(8501)
```

---

## Example usage flow (Colab / Streamlit)

1. Upload 1+ images
2. BLIP produces captions for each image
3. Captions are combined to form an outline prompt
4. Gemini generates chapter outlines and chapters
5. Story saved to text; exported to PDF and converted to MP3 via gTTS

---

## Notes on performance & costs

* BLIP and Gemini models can be compute‑intensive. Use GPU for BLIP for faster captioning.
* Google Gemini calls will incur API costs based on your Google Cloud/Billing account — monitor usage.
* gTTS and reportlab are lightweight and run locally without extra API costs.

---

## Troubleshooting

* **BLIP model download hangs / out of memory**: reduce image resolution, enable a GPU, or use smaller captioning models.
* **Gemini API errors**: ensure `GEMINI_API_KEY` is valid and not rate‑limited.
* **Streamlit UI errors**: check package versions and ensure `streamlit` and `torch` are correctly installed.

---

## Future improvements / TODO

* Add robust unit tests for captioning and generation functions
* Add streaming generation (token-by-token) for better UX
* Support alternative LLM backends (OpenAI, Anthropic) via adapter pattern
* Add explicit rate‑limit & retry logic for Gemini API calls
* Add Dockerfile and Github Actions for CI/CD and reproducible deployments

---

## License & Credits

* This project is provided for educational purposes. Check your organization’s licensing policy before reusing.
* Credits: DevTown bootcamp materials, Salesforce (BLIP), Hugging Face, Google Gemini, reportlab, gTTS, Streamlit.

---
